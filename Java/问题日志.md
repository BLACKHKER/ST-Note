## 开发问题日志

### 前端问题

#### 重复点击相同路由控制台报错

> 粘贴在Vue. Use(Router)上面

```js
// 获取原型对象上的push函数
const originalPush = Router.prototype.push
// 修改原型对象中的push方法
Router.prototype.push = function push(location) {
  return originalPush.call(this, location).catch(err => err)
}
Vue.use(Router)
```





#### VSCode执行npm run build打包失败

##### 问题现象

> 打包出现以下信息，或直接打包报错：
>
> ![image-20230317095621896](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202303170958944.png)



##### 解决方案

注释掉该代码

![image-20230317095743685](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202303170958128.png)

添加新代码

![image-20230317095814296](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202303170958160.png)





#### Vue重复点击相同路由控制台报错的问题

##### 解决方案

修改Vue.js

```js
//获取原型对象上的push函数
const originalPush = Router.prototype.push
//修改原型对象中的push方法
Router.prototype.push = function push(location) {
  return originalPush.call(this, location).catch(err => err)
}
// 放在这上面
Vue.use(Router)
```





#### Vue报错：This dependency was not found:* vue-editor-bridge

##### 解决方案

删除该代码，改行代码为VSCode自动添加的

```js
import func from 'vue-editor-bridge'
```



---



### 后端问题

#### idea运行WEB项目，光标自动跳转

##### 解决方案

Automatically show first error in editor：该功能表示自动显示编辑器中的第一个错误。取消勾选。

![image-20230213114536762](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/JSKe4OlEy62mpFs.png)





#### IDEA中文输出乱码

##### 问题现象

当我们敲完代码且当代码中包含有中文运行代码时，控制台输出的结果为乱码。

![图片](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/6yHhaF9u1QKc3pZ.png)



##### 解决方案

1. 打开 File --> settings --> Editor --> File Encodings，把编码都设置为 UTF-8 的形式

![图片](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/RlyxLWei8JbF5m2.png)

2. 打开idea的设置界面，搜索 maven ，点击 Maven --> Runner --> VM Options ，填上:

```
-Dfile.encoding=GB2312
```

![图片](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/RPEbaxJpHoenwZB.png)





#### idea中maven红色没正确识别变蓝色

##### 解决方案

打开项目对应pom.xml，右键，选择add maven project





#### idea创建类自动注释

打开设置 → Editor → File and Code Templates → includes

![image-20230625193153668](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/image-20230625193153668.png)

```java
/**
 * @Author BLACKHKER
 * @Date ${DATE} ${TIME}
 * @PackageName:${PACKAGE_NAME}
 * @ClassName: ${NAME}
 * @Description: TODO
 * @Version 1.0
 */
```





#### Idea中yml配置文件中文乱码

##### 解决方案

Settings → Editor → File Encodings → 将两个都改为UTF-8

> 修改完后配置文件中的中文会变成乱码，重新编写即可

![image-20230713230708611](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/image-20230713230708611.png)





#### Tomcat控制台、静态页面(非JSP)中文乱码

##### 解决方案

###### 控制台乱码

定位apache-tomcat-9.0.24\conf\logging文件，将里面的UTF-8全部改成GBK即可

![img](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/yxJnZI6qUFeNEvK.png)

###### web页面乱码

定位apache-tomcat-9.0.24\bin\catalina文件，打开并在最上方@echo off的下面加上以下代码

```
set "JAVA_OPTS=%JAVA_OPTS% %JSSE_OPTS%  -Dfile.encoding=UTF-8"
```

![img](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/4WcOazmVF79iPDB.png)

定位apache-tomcat-9.0.24\conf\server文件，在下图位置加上代码即可

```bat
useBodyEncodingForURI="true" URIEncoding="UTF-8"
```

页面(浏览器)清除缓存（ctrl+shift+del），重新刷新





#### 过滤器执行两次

##### 解决方案

前端发送了两次请求，浏览器发送了一个预检请求(OPTIONS请求)和实际请求。这是因为跨域资源共享(CORS)策略要求在发送某些类型的跨域请求之前，浏览器必须先发送一个预检请求。

预检请求的方法是OPTIONS，主要用于确认服务器是否允许原始请求。一旦服务器响应确认可以，浏览器才会发出实际的HTTP请求。这就是为什么过滤器执行两次，尤其是当请求方法是PUT或DELETE等需要预检的类型时。

调用以下方法查看是否包含OPTIONS请求：

```java
log.debug(req.getMethod() + " " + uri);
```





#### 往数据库中插入时间时，差了八个小时（时区设置）

##### 问题现象

在往数据库中插入（读取）时间的时候，会相差八个小时，原因是因为时区设置的问题：

UTC：**C**oordinated **U**niversal **T**ime 协调世界时。

GMT：**G**reenwich **M**ean **T**ime 格林尼治标准时间。（在协调世界时意义上的0时区，即GMT = UTC+0）

中国的时间是【东八区】，比GMT多八个小时，即 GMT+8（或UTC+8，但习惯上还是用GMT+8）

我们的系统时间是东八区，而我们连接数据库的时候若写成这样：

![img](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/z5mbPDaZKUoMTyA.png)

那么程序就会自动将我们获取到的系统时间减去八小时存入数据库，这就是数据库存取时间差距八小时的原因



##### 解决方案

将serverTimezone=UTC改为serverTimezone=GMT%2b8即可（GMT%2b8是GMT+8的意思）

![img](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/DrwHJBlpxzWYSki.png)





#### MyBatisPlus执行Insert执行两次

##### 解决方案

1. 取消勾选：将IDE构建/运行操作委托给Maven

![image-20230221180135991](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/vAXNTJaOdwPVBQk.png)

2. 勾选Skip Tests，跳过测试类

![image-20230221190452443](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/eokJs4ubR5TAx9M.png)





#### You can't specify target table '表名' for update in FROM clause

##### 为题现象

> 只有MySQL不支持这种情况
>
> 修改表的数据的同时，获取该表的数据去更新该表：
>
> ```SQL
> -- 报错示例
> UPDATE cart 
> SET num = (SELECT num FROM cart WHERE uid = 1 AND gid = 1) + 1
> ```
>



##### 解决方案

不能对进行查询操作的表进行update、delete等修改数据的操作，where条件中进行了子查询，并且子查询也是针对需要进行update操作的表的，mysql不支持这种查询修改的方式，可以曲线救国(子查询外嵌套子查询)

```SQL
-- 注意嵌套的子查询需要AS一下修改列名，以下示例AS列名为num1
-- 根据用户id(uid)和商品id(gid)查询出当前购物车的数量，增加该商品在购物车的数量(+1)
UPDATE cart 
SET num = (SELECT num FROM(SELECT num FROM cart WHERE uid = 1 AND gid = 1) AS num1) + 1
WHERE uid = 1 
AND gid = 1
```



---



### Devops

#### Linux安装完没有ip地址

##### 问题现象

> curl: (6)Could not resolve host: packages . wazuh .com;Unknowm error 
>
> CURL：(6)无法解析主机：包packages . wazuh .com。未知数错误

没有ip的状态：

![image-20230320110858575](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202303201114500.png)



##### 解决方案

切换到配置文件目录

```shell
cd /etc/sysconfig/network-scripts/
```

ls 查看network-scripts文件夹下ifcfg-enp0s3(不同电脑可能有不同的名字，根据自己电脑进行查看)

![image-20230320111053507](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202303201115522.png)

使用vi编辑ifcfg-enp0s3，把ONBOOT=no改为ONBOOT=yes

> 注意此时要**提供管理员用户**，先切到管理员用户即可更改ifcfg-enp0s3,普通用户不允许修改保存ifcfg-enp0s3

```shell
vi ifcfg-enp0s3 
```

![image-20230320111145597](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202303201115348.png)

保存退出后，重启网络服务

```shell
sudo service network restart
```

![image-20230320111316435](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202303201115791.png)

再次查询ip

```shell
ip addr
```

![image-20230320111404027](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202303201115588.png)





#### CentOS7.x：CURL工具使用失效重装

##### 问题现象

> curl xxx:-bash: curl: command not found

```shell
yum -y install curl 
```

提示软件包 curl-7.29.0-59.el7_9.1.x86_64 已安装并且是最新版本，无须任何处理

![image-20230412161807391](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202304121621221.png)

查询curl软件包是否存在

```shell
rpm -qa|grep curl
```

输出：

```shell
python-pycurl-7.19.0-19.el7.x86_64
libcurl-7.29.0-59.el7_9.1.x86_64
curl-7.29.0-59.el7_9.1.x86_64
```

![image-20230412161834203](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202304121621760.png)

的确已经安装了，但还是无法正常使用

```shell
curl --version	# -bash: curl: command not found
```

![image-20230412161851129](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202304121621927.png)



##### 解决方案

卸载重装

```shell
rpm -e --nodeps curl	# 警告：文件 /usr/bin/curl: 移除失败: 没有那个文件或目录
```

![image-20230412161915069](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202304121622851.png)

移除curl软件包

```shell
yum remove curl
```

![image-20230412161954152](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202304121622816.png)

查看卸载结果

```shell
rpm -qa|grep curl
#	python-pycurl-7.19.0-19.el7.x86_64
#	bcurl-7.29.0-59.el7_9.1.x86_64
```

![image-20230412162019716](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202304121622339.png)

重新安装

```shell
yum -y install curl
```

![image-20230412162111405](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202304121622847.png)

![image-20230412162128580](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202304121622889.png)

验证

```shell
curl icanhazip.com     -- 查看服务器公网IP	# 42.192.xxx.xxx
curl --version		   -- 查看curl版本
# curl 7.29.0 (x86_64-redhat-linux-gnu) libcurl/7.29.0 NSS/3.53.1 zlib/1.2.7 libidn/1.28 libssh2/1.8.0
```

![image-20230412162139963](https://typora-picture-zhao.oss-cn-beijing.aliyuncs.com/Typora/202304121622931.png)

