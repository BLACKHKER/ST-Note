### 方式一：定时线程池

```java
public class Pool {
	public static void main(String[] args) {
		//创建线程池
		ScheduledExecutorService pool = Executors.newScheduledThreadPool(1);
		//添加任务
		pool.scheduleAtFixedRate(new Runnable() {
			@Override
			public void run() {
				System.out.println("hello - "+new Date());
				
			}
		}, 0, 1, TimeUnit.SECONDS);
	}
}
```



### 方式二：Timer

创建任务类

```java
public class HelloTask extends TimerTask{
	@Override
	public void run() {
		System.out.println("hello - "+ new Date());
	}
}
```

测试类

```java
public class TimerTest {
	public static void main(String[] args) {
		//创建timer
		Timer timer = new Timer();
		//设置任务
		//参数1：任务  
		//参数2：延迟
		//参数3：间隔时间  毫秒
		timer.schedule(new HelloTask(), 0, 1000);
	}
}
```



### 方式三：SpringBoot定时任务

任务类

```java
@Configuration
@EnableScheduling	//开启定时任务
public class TaskTest {
    //指定策略
	@Scheduled(cron="0/5 * * * * ?")
	public void task() {
		System.out.println("定时任务:"+new Date());
	}
}
```

此处为每5秒执行一次



### 方式四：Quartz

Quartz是OpenSymphony开源组织在Job scheduling领域又一个开源项目，完全由Java开发，可以用来执行定时任务，类似于java.util.Timer。但是相较于Timer， Quartz增加了很多功能：

- 持久性作业 - 就是保持调度定时的状态;

- 作业管理 - 对调度作业进行有效的管理;

 

三个基本组成部分：

- 任务：Job

- 触发器：Trigger，包括SimpleTrigger和CronTrigger

- 调度器：Scheduler

 

Job

<img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/xiangwei/20210827144651.png" alt="image-20210827144651317" style="zoom:50%;" />

Trigger

实现触发任务去执行的触发器，触发器Trigger最基本的功能是指定Job的执行时间，执行间隔，运行次数等。

<img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/xiangwei/20210827144703.png" alt="image-20210827144703423" style="zoom:50%;" />



Scheduler

有了Job和Trigger后，怎么样将两者结合起来呢？即怎样指定Trigger去执行指定的Job呢？这时需要一个Schedule，来负责这个功能的实现。

<img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/xiangwei/20210827144715.png" alt="image-20210827144715207" style="zoom:50%;" />

代码演示：

导入依赖

```xml
<!-- Quartz -->
<dependency>
	<groupId>org.quartz-scheduler</groupId>
	<artifactId>quartz</artifactId>
	<version>2.3.0</version>
</dependency>
```

创建Job

```java
public class HelloJob implements Job{
	@Override
	public void execute(JobExecutionContext arg0) throws JobExecutionException {
		System.out.println("hello - "+new Date());
	}
}
```

测试类

```java
public class HelloScheduler {
	public static void main(String[] args) throws SchedulerException, InterruptedException {
		//1.创建调度器工厂
		SchedulerFactory factory = new StdSchedulerFactory();
		//2.调度器
		Scheduler scheduler = factory.getScheduler();
		//3.创建detail实例，绑定job
		JobDetail detail = JobBuilder.newJob(HelloJob.class).withIdentity("job", "j_group").build();
		//4.创建触发器
		Trigger trigger = TriggerBuilder.newTrigger().withIdentity("t1", "t_group")
				.startNow()//立即开始
				.withSchedule(
						SimpleScheduleBuilder.simpleSchedule()
						.withIntervalInSeconds(1)//每秒
						.repeatForever())//重复
				.build();
		//5.执行任务
		scheduler.scheduleJob(detail, trigger);
		System.out.println("start------------");
		scheduler.start();
		
		TimeUnit.MINUTES.sleep(1);//主线程睡眠一分钟之后执行
		scheduler.shutdown();
		System.out.println("end------------");
	}
}
```

也可以设置开始结束时间

```java
public class HelloScheduler {
	public static void main(String[] args) throws SchedulerException, InterruptedException {
		
		Date startDate = new Date();	//开始时间
		Date endDate = new Date();		//结束时间
		endDate.setTime(startDate.getTime()+5000);//相差5秒  执行5秒
		
		//1.创建调度器工厂
		SchedulerFactory factory = new StdSchedulerFactory();
		//2.调度器
		Scheduler scheduler = factory.getScheduler();
		//3.创建detail实例，绑定job
		JobDetail detail = JobBuilder.newJob(HelloJob.class).withIdentity("job", "j_group").build();
		//4.创建触发器
		Trigger trigger = TriggerBuilder.newTrigger().withIdentity("t1", "t_group")
				.startNow()
				.startAt(startDate)
				.endAt(endDate)
				.withSchedule(
						SimpleScheduleBuilder.simpleSchedule()
						.withIntervalInSeconds(1)//每秒
						.repeatForever())//重复
				.build();
		//5.执行任务
		scheduler.scheduleJob(detail, trigger);
		scheduler.start();
	}
}
```

利用Corntrigger实现复杂定时任务

```java
//2.创建调度器
public class HelloScheduler2 {
	public static void main(String[] args) throws SchedulerException, InterruptedException {
		
		Date startDate = new Date();	//开始时间
		Date endDate = new Date();		//结束时间
		endDate.setTime(startDate.getTime()+5000);//相差5秒  执行5秒
		
		//1.创建调度器工厂
		SchedulerFactory factory = new StdSchedulerFactory();
		//2.调度器
		Scheduler scheduler = factory.getScheduler();
		//3.创建detail实例，绑定job
		JobDetail detail = JobBuilder.newJob(HelloJob.class).withIdentity("job2", "j_group2").build();
		//4.创建触发器
		CronTrigger cronTrigger = TriggerBuilder.newTrigger()
									.withIdentity("t2", "g2")
									.startNow()
									.startAt(startDate)
									.endAt(endDate)
									.withSchedule(CronScheduleBuilder.cronSchedule("* * * * * ?"))
									.build();
		//5.执行
		scheduler.scheduleJob(detail, cronTrigger);
		scheduler.start();
	}
}
```



### CORN在线生成器

https://cron.qqe2.com/















